@using Kentico.Content.Web.Mvc
@using Kentico.PageBuilder.Web.Mvc
@using Kentico.Web.Mvc

@model Njh.Mvc.Models.Widgets.ImageSliderViewModel

@{
    var editMode = this.Context.Kentico().PageBuilder().EditMode;
    var autoplayValue = "false";
    if (Model != null)
    {
        autoplayValue = Model.Autoplay
        ? Model.SlideDuration.ToString()
        : "false";
    }
}

@if (Model?.Slides?.Count==0 && editMode)
{
    <h2>Image Slider widget: configuration is required.</h2>
}
else
{
    @* data-autoplay is a number for duration in millisec, OR is false for "no autoplay"
       Hide the play / pause controls when not auto-playing. *@

    <section class="image-slider" data-hook="imageSlider" data-autoplay="@autoplayValue">
    @if(autoplayValue != "false")
    {
        <button class="image-slider__toggle"
            data-state="playing"
            data-hook="imageSlider__toggle">
            <div class="image-slider__pause">
                    <span class="visually-hidden">{$NJH.ImageSlider.Pause$}</span>
                <svg class="app-icon"
                 xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 320 512">
                    <path d="M128 64H0V448H128V64zm192 0H192V448H320V64z" />
                </svg>
            </div>

            <div class="image-slider__play">
                    <span class="visually-hidden">{$NJH.ImageSlider.Play$}</span>
                <svg class="app-icon"
                 xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 384 512">
                    <path d="M384 256L0 32V480L384 256z" />
                </svg>
            </div>
        </button>
    }

        <div class="swiper" data-hook="imageSlider__swiper">
            <div class="swiper-wrapper">
            @foreach (var slide in Model.Slides)
            {
                var imgLinkOpen = "";
                var imgLinkClose = "";
                var imgLinkTitle = "";
                var imgWidthStr = slide.ImageWidth > 0
                    ? @"width=""{slide.ImageWidth}"""
                    : string.Empty;
                var imgHeightStr = slide.ImageHeight > 0
                    ? @"height=""{slide.ImageHeight}"""
                    : string.Empty;

                if (!string.IsNullOrEmpty(slide.SlideLinkUrl))
                {
                    imgLinkOpen = @"<a href=""" + slide.SlideLinkUrl + @"""";
                    imgLinkTitle = !string.IsNullOrEmpty(slide.SlideLinkTitle)
                    ? @" title=""" + slide.SlideLinkTitle + @""""
                    : "";
                    imgLinkOpen += imgLinkTitle + @">";
                    imgLinkClose = @"</a>";
                }

                <div class="swiper-slide">
                    <figure class="figure">
                        @Html.Raw(imgLinkOpen)
                        <img src="@slide.ImageSource"
                            class="figure-img"
                            loading="lazy"
                            alt="@slide.ImageAltText"
                             @imgWidthStr
                            @imgHeightStr />
                        @Html.Raw(imgLinkClose)

                        <figcaption class="figure-caption">
                            @Html.Raw(slide.ImageDescription)
                        </figcaption>
                    </figure>
                </div>
            }
            </div>

            <div class="swiper-pagination"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
        </div>
    </section>
}
